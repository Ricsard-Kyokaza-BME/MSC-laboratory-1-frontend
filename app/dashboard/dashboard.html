<div class="dashboard-project-container dashboard-grey-box container-fluid">
  <div class="row dashboard-project-title">
    <div class="col-1">
      <i class="material-icons" (click)="dashboardToggle()">list</i>
    </div>
    <div class="col-11 col-lg-8 dashboard-project-title-text" (click)="dashboardToggle()">
      <h4 class="max-1-lines" [title]="project.name | capitalize">{{project.name | capitalize}}</h4>
      <h6 class="max-2-lines" [title]="project.description | capitalize">{{project.description | capitalize}}</h6>
    </div>
    <div class="item-create-button col-12 col-lg-3 text-center text-lg-right mt-3 mt-lg-0">
      <button class="btn btn-outline-primary btn-sm" (click)="goToCreateSprint()"><i class="material-icons">add</i> <span>Sprint</span></button>
      <button class="btn btn-outline-primary btn-sm" (click)="goToCreateBacklogItem()"><i class="material-icons">add</i> <span>Backlog item</span></button>
    </div>
  </div>
  <div class="row dashboard-col-container" *ngIf="isOpen && isLoaded" [@fadeInOut]>
    <div class="dashboard-container container-white col-10 offset-1 col-md-5 offset-md-1 col-lg-3 offset-lg-0">
      <div>
        <span>Backlog Items</span>
        <div class="switch">
          <label>
            Change order
          </label>
          <ui-switch [(ngModel)]="orderSwitches.backlogSwitch"
                     [disabled]="!(sessionService.isProductOwnerSignedIn()) || dashboard.backlog.length == 0"
                     color="#3B70A6"></ui-switch>
        </div>
      </div>
      <ul *ngIf="!orderSwitches.backlogSwitch" class="collection"
          dnd-droppable (onDropSuccess)="dropDnDItem($event, backlogStatus.BACKLOG, 'backlog')" [dropZones]="['demo1']">
        <li class="dashboard-container-item empty-item" (click)="goToCreateBacklogItem()"
            *ngIf="dashboard.backlog.length == 0">
          Create a new item, or drag'n'drop one
        </li>
        <li class="dashboard-container-item"
            *ngFor="let item of dashboard.backlog"
            dnd-draggable [dragEnabled]="item" [dragData]="item" [dropZones]="['demo2']"
            (onDragSuccess)="removeDnDItem($event, 'backlog')"
            (click)="dashboardItemClicked(item)">
          <div class="dashboard-container-item-type">{{backlogItemType[item.type].substring(0,4)}}</div>
          {{item.title}}
          <div class="dashboard-container-in-sprint" *ngIf="isInTheSprint(item.id)">Sprint</div>
        </li>
      </ul>

      <ul *ngIf="orderSwitches.backlogSwitch" class="collection"
          dnd-sortable-container [sortableData]="dashboard.backlog" >
        <li class="dashboard-container-item"
            *ngFor="let item of dashboard.backlog; let i = index"
            [dragData]="item" (onDragSuccess)="onSortSuccess($event)"
            dnd-sortable [sortableIndex]="i">
          {{item.title}}
        </li>
      </ul>
    </div>

    <div class="dashboard-container container-red col-10 offset-1 col-md-5 offset-md-0 col-lg-3 offset-lg-0">
      <div>
        <span>Todo</span>
        <div class="switch">
          <label>
            Change order
          </label>
          <ui-switch [(ngModel)]="orderSwitches.todoSwitch"
                     [disabled]="orderSwitchesDisabled.todoSwitch || dashboard.todo.length == 0"
                     color="#3B70A6"></ui-switch>
        </div>
      </div>
      <ul *ngIf="!orderSwitches.todoSwitch" class="collection"
          dnd-droppable (onDropSuccess)="dropDnDItem($event, backlogStatus.TODO, 'todo')" [dropZones]="['demo2']">
        <li class="dashboard-container-item empty-item" (click)="goToCreateBacklogItem()"
            *ngIf="dashboard.todo.length == 0">
          Create a new item, or drag'n'drop one
        </li>
        <li class="dashboard-container-item"
            *ngFor="let item of dashboard.todo"
            dnd-draggable [dragEnabled]="item" [dragData]="item" [dropZones]="['demo1', 'demo3']"
            (onDragSuccess)="removeDnDItem($event, 'todo')"
            (click)="dashboardItemClicked(item)">
          <div class="dashboard-container-item-type">{{backlogItemType[item.type].substring(0,4)}}</div>
          {{item.title}}
          <div class="dashboard-container-in-sprint" *ngIf="isInTheSprint(item.id)">Sprint</div>
        </li>
      </ul>

      <ul *ngIf="orderSwitches.todoSwitch" class="collection"
          dnd-sortable-container [sortableData]="dashboard.todo">
        <li class="dashboard-container-item"
            *ngFor="let item of dashboard.todo; let i = index"
            [dragData]="item" (onDragSuccess)="onSortSuccess($event)"
            dnd-sortable [sortableIndex]="i">
          {{item.title}}
        </li>
      </ul>
    </div>

    <div class="dashboard-container container-yellow col-10 offset-1 col-md-5 offset-md-1 col-lg-3 offset-lg-0">
      <div>
        <span>In Progress</span>
        <div class="switch">
          <label>
            Change order
          </label>
          <ui-switch [(ngModel)]="orderSwitches.inProgressSwitch"
                     [disabled]="orderSwitchesDisabled.inProgressSwitch || dashboard.inProgress.length == 0"
                     color="#3B70A6"></ui-switch>
        </div>
      </div>
      <ul *ngIf="!orderSwitches.inProgressSwitch" class="collection"
          dnd-droppable (onDropSuccess)="dropDnDItem($event, backlogStatus.IN_PROGRESS, 'inProgress')" [dropZones]="['demo3']">
        <li class="dashboard-container-item empty-item" (click)="goToCreateBacklogItem()"
            *ngIf="dashboard.inProgress.length == 0">
          Create a new item, or drag'n'drop one
        </li>
        <li class="dashboard-container-item"
            *ngFor='let item of dashboard.inProgress'
            dnd-draggable [dragEnabled]="item" [dragData]="item" [dropZones]="['demo2', 'demo4']"
            (onDragSuccess)="removeDnDItem($event, 'inProgress')"
            (click)="dashboardItemClicked(item)">
          <div class="dashboard-container-item-type">{{backlogItemType[item.type].substring(0,4)}}</div>
          {{item.title}}
          <div class="dashboard-container-in-sprint" *ngIf="isInTheSprint(item.id)">Sprint</div>
        </li>
      </ul>

      <ul *ngIf="orderSwitches.inProgressSwitch" class="collection"
          dnd-sortable-container [sortableData]="dashboard.inProgress">
        <li class="dashboard-container-item"
            *ngFor="let item of dashboard.inProgress; let i = index"
            [dragData]="item" (onDragSuccess)="onSortSuccess($event)"
            dnd-sortable [sortableIndex]="i">
          {{item.title}}
        </li>
      </ul>
    </div>

    <div class="dashboard-container container-green col-10 offset-1 col-md-5 offset-md-0 col-lg-3 offset-lg-0">
      <div>
        <span>Done</span>
        <div class="switch">
          <label>
            Change order
          </label>
          <ui-switch [(ngModel)]="orderSwitches.doneSwitch"
                     [disabled]="orderSwitchesDisabled.doneSwitch || dashboard.done.length == 0"
                     color="#3B70A6"></ui-switch>
        </div>
      </div>
      <ul *ngIf="!orderSwitches.doneSwitch" class="collection"
          dnd-droppable (onDropSuccess)="dropDnDItem($event, backlogStatus.DONE, 'done')" [dropZones]="['demo4']">
        <li class="dashboard-container-item empty-item" (click)="goToCreateBacklogItem()"
            *ngIf="dashboard.done.length == 0">
          Create a new item, or drag'n'drop one
        </li>
        <li class="dashboard-container-item"
            *ngFor='let item of dashboard.done'
            dnd-draggable [dragEnabled]="item" [dragData]="item" [dropZones]="['demo3']"
            (onDragSuccess)="removeDnDItem($event, 'done')"
            (click)="dashboardItemClicked(item)">
          <div class="dashboard-container-item-type">{{backlogItemType[item.type].substring(0,4)}}</div>
          {{item.title}}
          <div class="dashboard-container-in-sprint" *ngIf="isInTheSprint(item.id)">Sprint</div>
        </li>
      </ul>

      <ul *ngIf="orderSwitches.doneSwitch" class="collection"
          dnd-sortable-container [sortableData]="dashboard.done">
        <li class="dashboard-container-item"
            *ngFor="let item of dashboard.done; let i = index"
            [dragData]="item" (onDragSuccess)="onSortSuccess($event)"
            dnd-sortable [sortableIndex]="i">
          {{item.title}}
        </li>
      </ul>
    </div>

  </div>

  <div class="row" *ngIf="isOpen && isLoaded" [@fadeInOut]>
    <div class="col-12 text-center">
      <span>Sprint <strong class="sprint-date">{{formatDate(dashboard.sprint.startTime)}}</strong> &rarr; <strong class="sprint-date">{{formatDate(dashboard.sprint.endTime)}}</strong></span>
    </div>
  </div>
</div>
